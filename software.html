<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Teorema de Bayes</title>
</head>
<body style="font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto;">

    <h1 style="color: #fff; text-align: center; margin-bottom: 30px; font-size: 32px;">Calculadoras de Probabilidad</h1>

    <!-- Navegación entre calculadoras -->
    <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 40px;">
        <button onclick="mostrarCalculadora('condicional')" id="btnCondicional"
                style="padding: 12px 24px; border: 2px solid #4CAF50; background: #4CAF50; color: white; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: bold; transition: all 0.3s;">
            Probabilidad Condicional
        </button>
        <button onclick="mostrarCalculadora('bayes')" id="btnBayes"
                style="padding: 12px 24px; border: 2px solid #667eea; background: transparent; color: #667eea; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: bold; transition: all 0.3s;">
            Teorema de Bayes
        </button>
    </div>

    <!-- CALCULADORA DE PROBABILIDAD CONDICIONAL -->
    <div id="calculadoraCondicional" style="display: block;">
        <h2 style="color: #fff; text-align: center; margin-bottom: 10px;">Calculadora de Probabilidad Condicional</h2>
        <p style="color: #fff; text-align: center; margin-bottom: 30px; font-size: 14px;">
            Calcula P(A|B) = Probabilidad de A dado que B ocurrió
        </p>

        <div style="border: 2px solid #4CAF50; border-radius: 8px; padding: 20px; margin-bottom: 20px; background: rgba(76, 175, 80, 0.05);">

            <div style="margin-bottom: 20px;">
                <label style="color: #fff; display: block; margin-bottom: 5px; font-weight: bold;">
                    P(A∩B) - Probabilidad de A y B juntos:
                </label>
                <input type="number" id="pAintersectB" min="0" max="1" step="0.01" value="0.25"
                       style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 16px;">
                <small style="color: #888;">Valor entre 0 y 1 (ejemplo: 0.25 = 25%)</small>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="color: #fff; display: block; margin-bottom: 5px; font-weight: bold;">
                    P(B) - Probabilidad de B:
                </label>
                <input type="number" id="pB_cond" min="0" max="1" step="0.01" value="0.40"
                       style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 16px;">
                <small style="color: #888;">Valor entre 0 y 1 (ejemplo: 0.40 = 40%)</small>
            </div>

            <button onclick="calcularCondicional()"
                    style="width: 100%; padding: 12px; color: white; border: none; border-radius: 4px; font-size: 16px; cursor: pointer; background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);">
                Calcular P(A|B)
            </button>
        </div>

        <div id="resultadoCondicional" style="border: 2px solid #4CAF50; border-radius: 8px; padding: 20px; display: none; background: rgba(76, 175, 80, 0.05);">
            <h2 style="color: #fff; margin-top: 0;">Resultado:</h2>
            <div style="color: #fff; font-size: 18px; margin-bottom: 15px;">
                <strong>P(A|B) = <span id="resultadoCondicionalValor" style="color: #4CAF50; font-size: 24px;"></span></strong>
            </div>
            <div style="color: #fff; font-size: 14px; line-height: 1.6;">
                <p style="margin: 5px 0;"><strong>Interpretación:</strong></p>
                <p id="interpretacionCondicional" style="margin: 5px 0;"></p>
            </div>

            <!-- Visualización -->
            <div style="margin-top: 25px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                <h3 style="color: #fff; margin-top: 0; text-align: center;">Visualización de Probabilidad Condicional</h3>
                <canvas id="conditionalChart" width="760" height="300" style="display: block; margin: 0 auto; background: white; border-radius: 8px;"></canvas>
                <p style="color: #aaa; font-size: 12px; text-align: center; margin-top: 10px;">
                    P(A|B) es la proporción de A∩B dentro de B
                </p>
            </div>

            <div style="margin-top: 20px; padding: 15px; border-left: 4px solid #4CAF50;">
                <p style="color: #fff; margin: 0; font-size: 14px;"><strong>Cálculo paso a paso:</strong></p>
                <p id="pasoAPasoCondicional" style="color: #fff; margin: 10px 0 0 0; font-size: 13px; line-height: 1.6;"></p>
            </div>
        </div>

        <div style="margin-top: 30px; padding: 15px; border: 1px solid #4CAF50; border-radius: 8px; background: rgba(76, 175, 80, 0.05);">
            <h3 style="color: #fff; margin-top: 0;">Fórmula de Probabilidad Condicional:</h3>
            <p style="color: #fff; font-size: 16px; text-align: center; margin: 15px 0; font-family: 'Courier New', monospace;">
                P(A|B) = P(A∩B) / P(B)
            </p>
            <p style="color: #aaa; font-size: 13px; text-align: center; margin: 5px 0;">
                La probabilidad de A dado B es igual a la probabilidad de que ambos ocurran dividida por la probabilidad de B
            </p>
        </div>
    </div>

    <!-- CALCULADORA DEL TEOREMA DE BAYES -->
    <div id="calculadoraBayes" style="display: none;">
        <h2 style="color: #fff; text-align: center; margin-bottom: 10px;">Calculadora del Teorema de Bayes</h2>
    <p style="color: #fff; text-align: center; margin-bottom: 30px; font-size: 14px;">
        Calcula P(A|B) = Probabilidad de A dado que B ocurrió
    </p>

    <div style="border: 2px solid #ddd; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
        
        <div style="margin-bottom: 20px;">
            <label style="color: #fff; display: block; margin-bottom: 5px; font-weight: bold;">
                P(A) - Probabilidad a priori de A:
            </label>
            <input type="number" id="pA" min="0" max="1" step="0.01" value="0.01" 
                   style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 16px;">
            <small style="color: #888;">Valor entre 0 y 1 (ejemplo: 0.01 = 1%)</small>
        </div>

        <div style="margin-bottom: 20px;">
            <label style="color: #fff; display: block; margin-bottom: 5px; font-weight: bold;">
                P(B|A) - Probabilidad de B dado que A es verdadero:
            </label>
            <input type="number" id="pBA" min="0" max="1" step="0.01" value="0.99" 
                   style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 16px;">
            <small style="color: #888;">Valor entre 0 y 1 (ejemplo: 0.99 = 99%)</small>
        </div>

        <div style="margin-bottom: 20px;">
            <label style="color: #fff; display: block; margin-bottom: 5px; font-weight: bold;">
                P(B|¬A) - Probabilidad de B dado que A es falso:
            </label>
            <input type="number" id="pBnotA" min="0" max="1" step="0.01" value="0.05" 
                   style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 16px;">
            <small style="color: #888;">Valor entre 0 y 1 (ejemplo: 0.05 = 5%)</small>
        </div>

        <button onclick="calcular()" 
                style="width: 100%; padding: 12px; color: white; border: none; border-radius: 4px; font-size: 16px; cursor: pointer; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            Calcular P(A|B)
        </button>
    </div>

    <div id="resultado" style="border: 2px solid #4CAF50; border-radius: 8px; padding: 20px; display: none;">
        <h2 style="color: #fff; margin-top: 0;">Resultado:</h2>
        <div style="color: #fff; font-size: 18px; margin-bottom: 15px;">
            <strong>P(A|B) = <span id="resultadoValor" style="color: #4CAF50; font-size: 24px;"></span></strong>
        </div>
        <div style="color: #fff; font-size: 14px; line-height: 1.6;">
            <p style="margin: 5px 0;"><strong>Interpretación:</strong></p>
            <p id="interpretacion" style="margin: 5px 0;"></p>
        </div>

        <!-- Gráfico de visualización -->
        <div style="margin-top: 25px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 8px;">
            <h3 style="color: #fff; margin-top: 0; text-align: center;">Visualización del Teorema de Bayes</h3>
            <canvas id="bayesChart" width="560" height="400" style="display: block; margin: 0 auto; background: white; border-radius: 8px;"></canvas>
            <p style="color: #aaa; font-size: 12px; text-align: center; margin-top: 10px;">
                El área verde representa P(A∩B), y el área total azul representa P(B)
            </p>
        </div>

        <div style="margin-top: 20px; padding: 15px; border-left: 4px solid #667eea;">
            <p style="color: #fff; margin: 0; font-size: 14px;"><strong>Cálculo paso a paso:</strong></p>
            <p id="pasoAPaso" style="color: #fff; margin: 10px 0 0 0; font-size: 13px; line-height: 1.6;"></p>
        </div>
    </div>

    <div style="margin-top: 30px; padding: 15px; border: 1px solid #e0e0e0; border-radius: 8px; background: rgba(102, 126, 234, 0.05);">
        <h3 style="color: #fff; margin-top: 0;">Fórmula del Teorema de Bayes:</h3>
        <p style="color: #fff; font-size: 14px; text-align: center; margin: 15px 0;">
            P(A|B) = [P(B|A) × P(A)] / [P(B|A) × P(A) + P(B|¬A) × P(¬A)]
        </p>
    </div>
    </div>

    <script>
        // Función para cambiar entre calculadoras
        function mostrarCalculadora(tipo) {
            const condDiv = document.getElementById('calculadoraCondicional');
            const bayesDiv = document.getElementById('calculadoraBayes');
            const btnCond = document.getElementById('btnCondicional');
            const btnBayes = document.getElementById('btnBayes');

            if (tipo === 'condicional') {
                condDiv.style.display = 'block';
                bayesDiv.style.display = 'none';
                btnCond.style.background = '#4CAF50';
                btnCond.style.color = 'white';
                btnBayes.style.background = 'transparent';
                btnBayes.style.color = '#667eea';
            } else {
                condDiv.style.display = 'none';
                bayesDiv.style.display = 'block';
                btnCond.style.background = 'transparent';
                btnCond.style.color = '#4CAF50';
                btnBayes.style.background = '#667eea';
                btnBayes.style.color = 'white';
            }
        }

        // Calculadora de Probabilidad Condicional
        function calcularCondicional() {
            const pAintersectB = parseFloat(document.getElementById('pAintersectB').value);
            const pB = parseFloat(document.getElementById('pB_cond').value);

            // Validar entrada
            if (isNaN(pAintersectB) || isNaN(pB)) {
                alert('Por favor ingresa valores numéricos válidos');
                return;
            }

            if (pAintersectB < 0 || pAintersectB > 1 || pB < 0 || pB > 1) {
                alert('Todos los valores deben estar entre 0 y 1');
                return;
            }

            if (pB === 0) {
                alert('P(B) no puede ser cero');
                return;
            }

            if (pAintersectB > pB) {
                alert('P(A∩B) no puede ser mayor que P(B)');
                return;
            }

            // Calcular P(A|B)
            const pAgivenB = pAintersectB / pB;

            // Mostrar resultado
            document.getElementById('resultadoCondicionalValor').textContent =
                (pAgivenB * 100).toFixed(2) + '% (' + pAgivenB.toFixed(4) + ')';

            // Interpretación
            let interpretacion = '';
            if (pAgivenB > 0.7) {
                interpretacion = 'Alta probabilidad de que A ocurra dado que B ha ocurrido. Esto indica una fuerte asociación entre A y B.';
            } else if (pAgivenB > 0.3) {
                interpretacion = 'Probabilidad moderada de que A ocurra dado que B ha ocurrido. Existe una asociación moderada entre A y B.';
            } else {
                interpretacion = 'Baja probabilidad de que A ocurra dado que B ha ocurrido. A y B tienen una asociación débil.';
            }
            document.getElementById('interpretacionCondicional').textContent = interpretacion;

            // Paso a paso
            const pasoAPaso = `
                <strong>Fórmula:</strong> P(A|B) = P(A∩B) / P(B)<br><br>
                <strong>Sustitución:</strong><br>
                P(A|B) = ${pAintersectB} / ${pB}<br>
                P(A|B) = ${pAgivenB.toFixed(4)}<br>
                P(A|B) = ${(pAgivenB * 100).toFixed(2)}%<br><br>
                <strong>Significado:</strong> De todas las veces que B ocurre, en ${(pAgivenB * 100).toFixed(2)}% de los casos también ocurre A.
            `;
            document.getElementById('pasoAPasoCondicional').innerHTML = pasoAPaso;

            // Mostrar resultado
            document.getElementById('resultadoCondicional').style.display = 'block';

            // Dibujar gráfico
            drawConditionalChart(pAintersectB, pB, pAgivenB);

            // Scroll
            document.getElementById('resultadoCondicional').scrollIntoView({ behavior: 'smooth' });
        }

        function drawConditionalChart(pAintersectB, pB, pAgivenB) {
            const canvas = document.getElementById('conditionalChart');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            // Limpiar
            ctx.clearRect(0, 0, width, height);

            const margin = 40;
            const chartWidth = width - 2 * margin;
            const chartHeight = 150;
            const startY = 80;

            // Título
            ctx.font = 'bold 18px Arial';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'center';
            ctx.fillText('Diagrama de Probabilidad Condicional', width / 2, 30);

            // Dibujar P(B) - la barra completa
            const widthB = chartWidth * pB;
            ctx.fillStyle = '#2196F3';
            ctx.fillRect(margin, startY, widthB, chartHeight);
            ctx.strokeStyle = '#1976D2';
            ctx.lineWidth = 3;
            ctx.strokeRect(margin, startY, widthB, chartHeight);

            // Etiqueta P(B)
            ctx.fillStyle = 'white';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('P(B)', margin + widthB / 2, startY - 10);
            ctx.font = '14px Arial';
            ctx.fillText((pB * 100).toFixed(1) + '%', margin + widthB / 2, startY + chartHeight + 20);

            // Dibujar P(A∩B) - dentro de P(B)
            const widthAB = chartWidth * pAintersectB;
            ctx.fillStyle = '#4CAF50';
            ctx.fillRect(margin, startY, widthAB, chartHeight);
            ctx.strokeStyle = '#388E3C';
            ctx.lineWidth = 3;
            ctx.strokeRect(margin, startY, widthAB, chartHeight);

            // Etiqueta P(A∩B)
            if (widthAB > 80) {
                ctx.fillStyle = 'white';
                ctx.font = 'bold 16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('P(A∩B)', margin + widthAB / 2, startY + chartHeight / 2 - 10);
                ctx.font = '14px Arial';
                ctx.fillText((pAintersectB * 100).toFixed(1) + '%', margin + widthAB / 2, startY + chartHeight / 2 + 10);
            } else if (widthAB > 0) {
                ctx.fillStyle = '#2E7D32';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'left';
                ctx.fillText('P(A∩B): ' + (pAintersectB * 100).toFixed(1) + '%', margin + widthAB + 5, startY + 20);
            }

            // Dibujar P(B - A) - la parte de B que no es A
            const widthBnotA = widthB - widthAB;
            if (widthBnotA > 5) {
                ctx.fillStyle = 'rgba(33, 150, 243, 0.3)';
                ctx.fillRect(margin + widthAB, startY, widthBnotA, chartHeight);
                ctx.strokeStyle = '#1976D2';
                ctx.lineWidth = 1;
                ctx.strokeRect(margin + widthAB, startY, widthBnotA, chartHeight);

                if (widthBnotA > 60) {
                    ctx.fillStyle = '#1976D2';
                    ctx.font = 'bold 14px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('B sin A', margin + widthAB + widthBnotA / 2, startY + chartHeight / 2);
                }
            }

            // Flecha y explicación
            const arrowY = startY + chartHeight + 60;
            ctx.fillStyle = '#333';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('P(A|B) es la proporción de A∩B dentro de B:', width / 2, arrowY);

            // Resultado final
            ctx.fillStyle = '#E8F5E9';
            ctx.fillRect(margin, arrowY + 20, chartWidth, 50);
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 3;
            ctx.strokeRect(margin, arrowY + 20, chartWidth, 50);

            ctx.fillStyle = '#2E7D32';
            ctx.font = 'bold 18px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(
                'P(A|B) = ' + (pAintersectB * 100).toFixed(2) + '% / ' + (pB * 100).toFixed(2) + '% = ' + (pAgivenB * 100).toFixed(2) + '%',
                width / 2,
                arrowY + 48
            );
        }

        // Calculadora de Teorema de Bayes (función original)
        function calcular() {
            // Obtener valores
            const pA = parseFloat(document.getElementById('pA').value);
            const pBA = parseFloat(document.getElementById('pBA').value);
            const pBnotA = parseFloat(document.getElementById('pBnotA').value);

            // Validar entrada
            if (isNaN(pA) || isNaN(pBA) || isNaN(pBnotA)) {
                alert('Por favor ingresa valores numéricos válidos');
                return;
            }

            if (pA < 0 || pA > 1 || pBA < 0 || pBA > 1 || pBnotA < 0 || pBnotA > 1) {
                alert('Todos los valores deben estar entre 0 y 1');
                return;
            }

            // Calcular P(¬A)
            const pNotA = 1 - pA;

            // Calcular P(B) - Probabilidad total de B
            const pB = (pBA * pA) + (pBnotA * pNotA);

            // Calcular P(A|B) usando el Teorema de Bayes
            const pAgivenB = (pBA * pA) / pB;

            // Mostrar resultado
            document.getElementById('resultadoValor').textContent = 
                (pAgivenB * 100).toFixed(2) + '% (' + pAgivenB.toFixed(4) + ')';

            // Interpretación
            let interpretacion = '';
            if (pAgivenB > 0.7) {
                interpretacion = 'Alta probabilidad de que A sea verdadero dado que B ocurrió.';
            } else if (pAgivenB > 0.3) {
                interpretacion = 'Probabilidad moderada de que A sea verdadero dado que B ocurrió.';
            } else {
                interpretacion = 'Baja probabilidad de que A sea verdadero dado que B ocurrió.';
            }
            document.getElementById('interpretacion').textContent = interpretacion;

            // Paso a paso
            const pasoAPaso = `
                1. P(¬A) = 1 - P(A) = 1 - ${pA} = ${pNotA.toFixed(4)}<br>
                2. P(B) = P(B|A) × P(A) + P(B|¬A) × P(¬A)<br>
                   P(B) = ${pBA} × ${pA} + ${pBnotA} × ${pNotA.toFixed(4)} = ${pB.toFixed(4)}<br>
                3. P(A|B) = [P(B|A) × P(A)] / P(B)<br>
                   P(A|B) = [${pBA} × ${pA}] / ${pB.toFixed(4)} = ${pAgivenB.toFixed(4)}
            `;
            document.getElementById('pasoAPaso').innerHTML = pasoAPaso;

            // Mostrar el div de resultado
            document.getElementById('resultado').style.display = 'block';

            // Dibujar el gráfico
            drawBayesChart(pA, pBA, pBnotA, pAgivenB, pB);

            // Scroll suave al resultado
            document.getElementById('resultado').scrollIntoView({ behavior: 'smooth' });
        }

        function drawBayesChart(pA, pBA, pBnotA, pAgivenB, pB) {
            const canvas = document.getElementById('bayesChart');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            // Limpiar canvas
            ctx.clearRect(0, 0, width, height);

            // Configuración
            const margin = 40;
            const chartWidth = width - 2 * margin;
            const chartHeight = height - 2 * margin - 60;
            const barHeight = 80;
            const spacing = 20;

            // Calcular P(¬A)
            const pNotA = 1 - pA;

            // Calcular intersecciones
            const pAandB = pBA * pA;
            const pNotAandB = pBnotA * pNotA;

            // Título
            ctx.font = 'bold 16px Arial';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'center';
            ctx.fillText('Diagrama de Probabilidades', width / 2, 25);

            // Posición Y para cada barra
            let currentY = margin + 30;

            // ===== BARRA 1: P(A) y P(¬A) =====
            ctx.font = 'bold 14px Arial';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'left';
            ctx.fillText('Probabilidades a priori:', margin, currentY - 5);

            // P(A) - color morado
            const widthPA = chartWidth * pA;
            ctx.fillStyle = '#9C27B0';
            ctx.fillRect(margin, currentY, widthPA, barHeight);
            ctx.strokeStyle = '#7B1FA2';
            ctx.lineWidth = 2;
            ctx.strokeRect(margin, currentY, widthPA, barHeight);

            // Etiqueta P(A)
            if (widthPA > 50) {
                ctx.fillStyle = 'white';
                ctx.font = 'bold 13px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('P(A)', margin + widthPA / 2, currentY + barHeight / 2 - 10);
                ctx.font = '12px Arial';
                ctx.fillText((pA * 100).toFixed(1) + '%', margin + widthPA / 2, currentY + barHeight / 2 + 10);
            }

            // P(¬A) - color gris
            const widthPNotA = chartWidth * pNotA;
            ctx.fillStyle = '#757575';
            ctx.fillRect(margin + widthPA, currentY, widthPNotA, barHeight);
            ctx.strokeStyle = '#616161';
            ctx.lineWidth = 2;
            ctx.strokeRect(margin + widthPA, currentY, widthPNotA, barHeight);

            // Etiqueta P(¬A)
            if (widthPNotA > 50) {
                ctx.fillStyle = 'white';
                ctx.font = 'bold 13px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('P(¬A)', margin + widthPA + widthPNotA / 2, currentY + barHeight / 2 - 10);
                ctx.font = '12px Arial';
                ctx.fillText((pNotA * 100).toFixed(1) + '%', margin + widthPA + widthPNotA / 2, currentY + barHeight / 2 + 10);
            }

            currentY += barHeight + spacing + 20;

            // ===== BARRA 2: P(B|A) y P(B|¬A) =====
            ctx.font = 'bold 14px Arial';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'left';
            ctx.fillText('Probabilidad de B en cada escenario:', margin, currentY - 5);

            // P(B|A) dentro de P(A)
            const widthPBA = widthPA * pBA;
            ctx.fillStyle = '#4CAF50';
            ctx.fillRect(margin, currentY, widthPBA, barHeight);
            ctx.strokeStyle = '#388E3C';
            ctx.lineWidth = 2;
            ctx.strokeRect(margin, currentY, widthPBA, barHeight);

            // Etiqueta P(B|A)
            if (widthPBA > 50) {
                ctx.fillStyle = 'white';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('P(B|A)', margin + widthPBA / 2, currentY + barHeight / 2 - 8);
                ctx.font = '11px Arial';
                ctx.fillText((pBA * 100).toFixed(1) + '%', margin + widthPBA / 2, currentY + barHeight / 2 + 8);
            }

            // P(¬B|A) - parte no B en A
            const widthNotBA = widthPA - widthPBA;
            ctx.fillStyle = '#E1BEE7';
            ctx.fillRect(margin + widthPBA, currentY, widthNotBA, barHeight);
            ctx.strokeStyle = '#BA68C8';
            ctx.lineWidth = 1;
            ctx.strokeRect(margin + widthPBA, currentY, widthNotBA, barHeight);

            // P(B|¬A) dentro de P(¬A)
            const widthPBNotA = widthPNotA * pBnotA;
            ctx.fillStyle = '#2196F3';
            ctx.fillRect(margin + widthPA, currentY, widthPBNotA, barHeight);
            ctx.strokeStyle = '#1976D2';
            ctx.lineWidth = 2;
            ctx.strokeRect(margin + widthPA, currentY, widthPBNotA, barHeight);

            // Etiqueta P(B|¬A)
            if (widthPBNotA > 50) {
                ctx.fillStyle = 'white';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('P(B|¬A)', margin + widthPA + widthPBNotA / 2, currentY + barHeight / 2 - 8);
                ctx.font = '11px Arial';
                ctx.fillText((pBnotA * 100).toFixed(1) + '%', margin + widthPA + widthPBNotA / 2, currentY + barHeight / 2 + 8);
            }

            // P(¬B|¬A) - parte no B en ¬A
            const widthNotBNotA = widthPNotA - widthPBNotA;
            ctx.fillStyle = '#E0E0E0';
            ctx.fillRect(margin + widthPA + widthPBNotA, currentY, widthNotBNotA, barHeight);
            ctx.strokeStyle = '#BDBDBD';
            ctx.lineWidth = 1;
            ctx.strokeRect(margin + widthPA + widthPBNotA, currentY, widthNotBNotA, barHeight);

            currentY += barHeight + spacing + 25;

            // ===== Resumen final =====
            ctx.font = 'bold 14px Arial';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'left';
            ctx.fillText('Resultado (Teorema de Bayes):', margin, currentY - 5);

            // Leyenda de colores
            const legendY = currentY + 5;
            const legendSpacing = 180;

            // P(A∩B) - verde
            ctx.fillStyle = '#4CAF50';
            ctx.fillRect(margin, legendY, 20, 20);
            ctx.strokeStyle = '#388E3C';
            ctx.lineWidth = 1;
            ctx.strokeRect(margin, legendY, 20, 20);
            ctx.fillStyle = '#333';
            ctx.font = '12px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('P(A∩B) = ' + (pAandB * 100).toFixed(2) + '%', margin + 25, legendY + 15);

            // P(¬A∩B) - azul
            ctx.fillStyle = '#2196F3';
            ctx.fillRect(margin + legendSpacing, legendY, 20, 20);
            ctx.strokeStyle = '#1976D2';
            ctx.strokeRect(margin + legendSpacing, legendY, 20, 20);
            ctx.fillStyle = '#333';
            ctx.fillText('P(¬A∩B) = ' + (pNotAandB * 100).toFixed(2) + '%', margin + legendSpacing + 25, legendY + 15);

            // P(B) total
            ctx.fillStyle = '#333';
            ctx.font = 'bold 12px Arial';
            ctx.fillText('P(B) = ' + (pB * 100).toFixed(2) + '%', margin + legendSpacing * 2, legendY + 15);

            // Resultado final destacado
            const resultY = legendY + 40;
            ctx.fillStyle = '#F0F4C3';
            ctx.fillRect(margin, resultY, chartWidth, 35);
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 3;
            ctx.strokeRect(margin, resultY, chartWidth, 35);

            ctx.fillStyle = '#2E7D32';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('P(A|B) = P(A∩B) / P(B) = ' + (pAgivenB * 100).toFixed(2) + '% (' + pAgivenB.toFixed(4) + ')',
                        width / 2, resultY + 22);
        }

        // Permitir calcular con Enter
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                calcular();
            }
        });
    </script>

</body>
</html>